<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>passim-results.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Passim evaluation</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/index-DgI7bmFZ.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.9/dist/assets/index-B-hr6ABS.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
<style title='marimo-custom'>:root {
	/* define highlight colors here as CSS variables */

/* https://observablehq.com/@jotasolano/paul-tol-schemes */
/* qualitative vibrant
	["#EE7733","#0077BB","#33BBEE","#EE3377","#CC3311","#009988"] */
	--light-highlight-color1: #EE7733;
	--light-highlight-color2: #0077BB;
	--light-highlight-color3: #009988;	
	--light-highlight-color4: #EE3377;	
	--light-highlight-color5: #33BBEE;	
	--light-highlight-color6: #CC3311;		


	/* qualitative bright
["#4477AA","#EE6677","#228833","#CCBB44","#66CCEE","#AA3377"]  */
	--dark-highlight-color1: #4477AA;
	--dark-highlight-color2: #EE6677;
	--dark-highlight-color3: #228833;
	--dark-highlight-color4: #CCBB44;
	--dark-highlight-color5: #66CCEE;
	--dark-highlight-color6: #AA3377;

}

mark {
	/* override default styles for mark; remove highlight/color, add underline */
	background-color: transparent;
	color: currentColor;

	/* set separate styles so it is easier to override */
	text-decoration-line: underline;
	text-decoration-style: solid;
	text-decoration-color: light-dark(var(--light-highlight-color1), var(--dark-highlight-color1));
	text-decoration-thickness: 2px;
    text-underline-offset: 3px;
}


section.page {
	white-space: pre-line;
	position: relative;
}

section.page header {
	position: sticky;
	top: -1em;	  /* adjust for scrolling within marimo cell */
	padding-top: 1em;
	padding-bottom: 1em;
	border-bottom: 1px solid currentColor;
	background-color: var(--background);
}


p.info {
	font-size: smaller;
	position: absolute;
	top: 1em;
	right: 5px;
}

section header h1 {
	font-weight: bold;
}

dl dt {
	font-weight: bold;
	display: inline-block;
}
dl dt::after {
	content: ": ";
}

dl dd {
	display: inline-block;
	padding-left: 2px;
	padding-right: 1em;
}


.compare {
	position: relative;
}
.compare.multi > div, .compare.primary, .compare.secondary {
	/* this is useful but not being applied consistently; disable for now */
	white-space: pre-line;
}

.compare.multi > div:not(:first-child) {
	position: absolute;
	top: 0;
	left: 0;
}

/* for any div after the first, make the text transparent to avoid artifacts
 when text does not exactly align (although beware of texts that differ too much!) */
.compare.multi div:nth-child(n+2) {
	/* comment color and uncomment opacity to test */
	color: transparent;
/*	opacity: 0.2;*/
}

.highlight2 mark {
	text-decoration-color: light-dark(var(--light-highlight-color2), var(--dark-highlight-color2));
	text-decoration-style: wavy;
	text-decoration-thickness: 1px;	 /* 2px wavy looks too thick */
}

.highlight3 mark {
	text-decoration-color: light-dark(var(--light-highlight-color3), var(--dark-highlight-color3));
	text-decoration-style: dotted;
	text-decoration-thickness: 4px;	 /* 2px dotted is hard to see*/
    text-underline-offset: 4px;
}

.compare.multi div:nth-child(n+2) mark, .compare.secondary mark {
	/* use wavy underlines for secondary highlights;
	everything after the first div in a span-compare section, or secondary-span
	 */
	text-decoration-style: wavy;
    text-underline-offset: 5px;
	text-decoration-thickness: 1px;
	text-decoration-color: light-dark(var(--light-highlight-color2), var(--dark-highlight-color3));
}

.compare.multi  div:nth-child(3) mark {
	text-decoration-style: dotted;
	text-decoration-color: light-dark(var(--light-highlight-color3), var(--dark-highlight-color3));
}
.compare.multi  div:nth-child(4) mark {
	text-decoration-color: light-dark(var(--light-highlight-color4), var(--dark-highlight-color4));
}
.compare.multi  div:nth-child(5) mark {
	text-decoration-color: light-dark(var(--light-highlight-color5), var(--dark-highlight-color5));
}</style></head>
  <body>
    <div id="root"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "passim-results.py",
            "mode": "read",
            "version": "0.14.9",
            "serverToken": "static",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "below", "code_editor_font_size": 14, "custom_css": [], "dataframes": "rich", "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "system"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"app_title": "Passim evaluation", "css_file": "highlight.css", "sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport polars as pl", "code_hash": "ce4194fff5fe8b0eebb7a09769bc0473", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "df = pl.read_ndjson(\n    \"data/passim/output/default/out.json/part-00000-dbd8cab7-6c9f-4866-b676-ff2bcd4b0890-c000.json\"\n)\ndf", "code_hash": "44db16a535f5887950f6ee9348917332", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "unique_clusters = len(df[\"cluster\"].unique())\ncluster_sizes = \",\".join([str(s) for s in df[\"size\"].unique().to_list()])\n\nmo.md(f\"Found **{unique_clusters}** clusters of size **{cluster_sizes}**.\")", "code_hash": "643427fd2ba6323b584afd12c53afea4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"This output shows the matching text content from the two texts.\"\"\")", "code_hash": "4feddf6c8a3c41cc3a1e4ccd4cab0e62", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "output = []\n\nfor cluster, rows in df.group_by(\"cluster\"):\n    dnz_content = rows.filter(pl.col(\"series\") == \"dnz\").row(0, named=True)\n    mega_content = rows.filter(pl.col(\"series\") == \"mega\").row(0, named=True)\n\n    output.append(f\"#### {dnz_content['id']} <> MEGA {mega_content['id']}\")\n    output.append(\"**DNZ text:**\\n\")\n    output.append(dnz_content[\"text\"])\n    output.append(\"\\n**MEGA text:**\\n\")\n    output.append(mega_content[\"text\"])\n    output.append(\"---\")\n\n\nmo.md(\"\\n\".join(output))", "code_hash": "94f47ece71035ec7eac1606532617d33", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"Load sentence corpora and use character indices to get a list of sentences overlapping with the passages found by passim.\"\"\"\n)", "code_hash": "2daac0fb06746be6c91b48d0e50e663a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "marx_sentences = pl.read_ndjson(\n    \"data/sentence-corpora/mega-sample-sents.jsonl\"\n)\n# calculate sentence end index\nmarx_sentences = marx_sentences.with_columns(\n    char_end_idx=pl.col(\"char_idx\").add(pl.col(\"text\").str.len_chars())\n)\ndnz_sentences = pl.read_ndjson(\n    (\"data/sentence-corpora/dnz-sample-sents.jsonl\")\n)\n# calculate sentence end index\ndnz_sentences = dnz_sentences.with_columns(\n    char_end_idx=pl.col(\"char_idx\").add(pl.col(\"text\").str.len_chars())\n)", "code_hash": "57c30b7eab770770b3e147ff4d8304d7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "# passim id is filename without extensin; add it back for matching\npassim_df = df.with_columns(file=pl.col(\"id\") + pl.lit(\".txt\"))\n# combine sentence corpora into a single dataframe\nall_sentences = pl.concat([marx_sentences, dnz_sentences])\n\n# then do a conditional join to get sentence ids for passim results\npassim_df = passim_df.join_where(\n    all_sentences,\n    # join based on filename and any overlapping characters\n    # we expect multiple sentences for several of the passages found by passim\n    pl.col(\"file\") == pl.col(\"file_right\"),\n    pl.col(\"begin\") < pl.col(\"char_end_idx\"),\n    pl.col(\"end\") > pl.col(\"char_idx\"),\n)\n# select the fields we need to keep for evaluation\npassim_df = passim_df.select(\n    \"cluster\",\n    \"file\",\n    \"sent_id\",\n    \"series\",\n    \"begin\",\n    \"end\",\n    \"char_idx\",\n    \"char_end_idx\",\n    \"text\",\n    \"text_right\",\n)", "code_hash": "193a280b19f61faa54cefa434724c7e1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "# get a list of all sentences for each series\npassim_marx_sent_ids = set(\n    passim_df.filter(pl.col(\"series\") == \"mega\")[\"sent_id\"].to_list()\n)\npassim_dnz_sent_ids = set(\n    passim_df.filter(pl.col(\"series\") == \"dnz\")[\"sent_id\"].to_list()\n)", "code_hash": "9fa51d133ff0d8b89737081a61f37f10", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"Load evaluation data and sentence corpora for comparison and evaluation of passim results.\"\"\"\n)", "code_hash": "86a798a3fbd36e4de1d23b645aefec3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "# load the evaulation data and filter to those that have sentence ids for both sentence corpora\neval_pairs_df = pl.read_csv(\n    \"data/sentence-eval-pairs/dnz_marx_sentence_pairs.csv\"\n)\neval_pairs_df = eval_pairs_df.filter(\n    pl.col(\"marx_sent_id\").is_not_null(), pl.col(\"dnz_sent_id\").is_not_null()\n)\neval_pairs_df", "code_hash": "222416938b97ed1cf093213d590498a8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "# what is the overlap between sentence ids?\neval_marx_sent_ids = set(eval_pairs_df[\"marx_sent_id\"].to_list())\neval_dnz_sent_ids = set(eval_pairs_df[\"dnz_sent_id\"].to_list())\n\npassim_marx_sent_ids.issuperset(eval_marx_sent_ids)\n# in common\npassim_marx_sent_ids & eval_marx_sent_ids\n# passim_marx_sent_ids\n\n# report on how they match up\nmo.md(f\"\"\"## Passim sentence id comparison\n\nComparing passim matches with sentence evaluation pairs based on sentence id. For passim, we include any sentence that overlaps with the passage.\n\n### Marx sentences\n- {len(eval_marx_sent_ids)} marx sentence ids in evaluation data.\n- {len(passim_marx_sent_ids)} marx sentence ids in passim results.\n- {len(eval_marx_sent_ids & passim_marx_sent_ids)} sentence ids in common.\n- {len(passim_marx_sent_ids - eval_marx_sent_ids)} sentence ids in passim results not in evaluation data:\n> {(passim_marx_sent_ids - eval_marx_sent_ids)}\n\n### DNZ sentences\n- {len(eval_dnz_sent_ids)} marx sentence ids in evaluation data.\n- {len(passim_dnz_sent_ids)} marx sentence ids in passim results.\n- {len(eval_dnz_sent_ids & passim_dnz_sent_ids)} sentence ids in common.\n- {len(passim_dnz_sent_ids - eval_dnz_sent_ids)} sentence ids in passim results not in evaluation data:\n> {(passim_dnz_sent_ids - eval_dnz_sent_ids)}\n\n\"\"\")", "code_hash": "10daab6c58ce3fe7dfd3fc9946c74f4c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "# join marx and dnz sentences in order to get character indices for highlighting\neval_df = eval_pairs_df.join(\n    marx_sentences.select(\"sent_id\", \"file\", \"char_idx\", \"char_end_idx\"),\n    left_on=pl.col(\"marx_sent_id\"),\n    right_on=pl.col(\"sent_id\"),\n    how=\"left\",\n).rename(\n    {\n        \"char_idx\": \"marx_start_index\",\n        \"char_end_idx\": \"marx_end_index\",\n        \"file\": \"marx_file\",\n    }\n)", "code_hash": "afbf42c00d77338a15c2ea63a1a98869", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "# get the DNZ sentences in our evaluation pairs, so we can highlight them\ndnz_eval_sent_ids = eval_pairs_df[\"dnz_sent_id\"].unique().to_list()\ndnz_eval_sents = dnz_sentences.filter(\n    pl.col(\"sent_id\").is_in(dnz_eval_sent_ids)\n)\ndnz_eval_sents", "code_hash": "b3713e58db1ae93f8b33e998368b0327", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "uniq_clusters = passim_df[\"cluster\"].unique().to_list()\ncluster_slider = mo.ui.slider(\n    start=0,\n    stop=len(uniq_clusters) - 1,\n    step=1,\n    label=\"passim cluster\",\n)\ncluster_slider", "code_hash": "875c5ec9c1ee602ece3ed694e978a0f8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "# create panels with highlighted text\nfrom remarx.highlight_utils import highlight_spans\n\n\ndef highlight_passim_passages():\n    # get cluster id\n    cluster_id = uniq_clusters[cluster_slider.value]\n    # find passim passages for dnz text in cluster\n    passim_passages = passim_df.filter(\n        pl.col(\"cluster\").eq(cluster_id),\n        pl.col(\"series\").eq(\"dnz\"),\n    )\n    dnz_filename = passim_passages.row(0, named=True)[\"file\"]\n    with open(f\"data/dnz-sample-articles/{dnz_filename}\") as dnzfile:\n        dnztext = dnzfile.read()\n\n    spans = passim_passages.select(\"char_idx\", \"char_end_idx\").rows()\n\n    highlighted_text = highlight_spans(dnztext, spans)\n    # subset the text around the quotes with some padding\n    min_index = passim_passages[\"char_idx\"].min() - 150\n    max_index = passim_passages[\"char_end_idx\"].max() + 350\n\n    highlighted_text = highlighted_text[min_index:max_index]\n    return cluster_id, highlighted_text, dnz_filename, min_index, max_index\n\n\ndef passim_panel(cluster_id, highlighted_text):\n    return mo.Html(\n        \"<section class='page'><header><h1>passim</h2>\"\n        + f\"<p class='info'>cluster {cluster_id}</p></header>\"\n        + highlighted_text\n        + \"</section>\"\n    )\n\n\ndef highlight_sentence_pairs(dnz_filename, min_index, max_index):\n    eval_subset = dnz_eval_sents.filter(\n        pl.col(\"file\").eq(dnz_filename),\n        pl.col(\"char_idx\") < max_index,\n        pl.col(\"char_end_idx\") > min_index,\n    )\n    spans = eval_subset.select(\"char_idx\", \"char_end_idx\").rows()\n\n    with open(f\"data/dnz-sample-articles/{dnz_filename}\") as dnzfile:\n        dnztext = dnzfile.read()\n\n    return highlight_spans(dnztext, spans)[min_index:max_index]\n\n\ndef eval_panel(text):\n    return mo.Html(\n        \"<section class='page highlight2'><header><h1>evaluation sentence pairs</h2></header>\"\n        + text\n        + \"</section>\"\n    )\n\n\ncluster_id, highlighted_text, dnz_filename, min_index, max_index = (\n    highlight_passim_passages()\n)\n\nmo.hstack(\n    [\n        passim_panel(cluster_id, highlighted_text),\n        eval_panel(\n            highlight_sentence_pairs(dnz_filename, min_index, max_index)\n        ),\n    ],\n    justify=\"center\",\n)", "code_hash": "cabdf2e994c4d8e9711c25b8dca33aa1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Conclusion\n\nAll of the sentence in our evaluation pairs are found by passim.\n\nPassim also finds additional sentences; the sentences found are around the passages of interest, so passim is identifying extra content we did not include before or after the quote.\n\nThe gaps in some of the quotations also means that passim groups interrupted quotes in different clusters.\n\"\"\"\n)", "code_hash": "e854d7c63d6778fb4d499f45b60c541d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}], "metadata": {"marimo_version": "0.14.9"}, "version": "1"},
            "session": {"cells": [{"code_hash": "ce4194fff5fe8b0eebb7a09769bc0473", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "44db16a535f5887950f6ee9348917332", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='MJUe-0' random-id='3fee1158-e77c-fd63-8d5f-fb36c92e4adc'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;uid&#92;&quot;:&#92;&quot;263171422598165348&#92;&quot;,&#92;&quot;cluster&#92;&quot;:0,&#92;&quot;begin&#92;&quot;:11229,&#92;&quot;end&#92;&quot;:11609,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;dnz&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot;r Werth dieser Kraft (der Arbeitskraft) h&#92;&#92;u00f6her, so &#92;&#92;u00e4u&#92;&#92;u00dfert sie&#92;&#92;nsich aber auch in h&#92;&#92;u00f6herer Arbeit und vergegenst&#92;&#92;u00e4ndlicht sich daher () in den&#92;&#92;u00ac&#92;&#92;nselben Zeitr&#92;&#92;u00e4umen in verh&#92;&#92;u00e4ltni&#92;&#92;u00dfm&#92;&#92;u00e4&#92;&#92;u00dfig h&#92;&#92;u00f6heren Werthen&#92;&#92;u201c (&#92;&#92;u201eArbeitsproze&#92;&#92;u00df und&#92;&#92;nVerwerthungsproze&#92;&#92;u00df&#92;&#92;u201c Band 1, 2. Auflage, S. 186). Hier erscheint der Werth&#92;&#92;u00ac&#92;&#92;nder Arbeitskraft, der sich im Arbeitslohn vergegenst&#92;&#92;u00e4ndlicht, als entscheidend f&#92;&#92;u00fcr&#92;&#92;nden Werth&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;1391352390715025973&#92;&quot;,&#92;&quot;cluster&#92;&quot;:0,&#92;&quot;begin&#92;&quot;:2,&#92;&quot;end&#92;&quot;:514,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[{&#92;&quot;uid&#92;&quot;:&#92;&quot;263171422598165348&#92;&quot;,&#92;&quot;begin&#92;&quot;:11229,&#92;&quot;end&#92;&quot;:11609}],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;p147&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;mega&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; &#92;&#92;nwerth hat als die einfache Arbeitskraft. Ist der Werth dieser Kraft h&#92;&#92;u00f6her, &#92;&#92;nso &#92;&#92;u00e4u&#92;&#92;u00dfert sie sich aber auch in h&#92;&#92;u00f6herer Arbeit und vergegenst&#92;&#92;u00e4ndlicht sich &#92;&#92;n   daher, in denselben Zeitr&#92;&#92;u00e4umen, in verh&#92;&#92;u00e4ltni&#92;&#92;u00dfm&#92;&#92;u00e4&#92;&#92;u00dfig h&#92;&#92;u00f6heren Werthen. &#92;&#92;nWelches jedoch immer der Gradunterschied zwischen Spinnarbeit und &#92;&#92;nJuwelierarbeit, die Portion Arbeit, wodurch der Juwelenarbeiter nur den &#92;&#92;nWerth seiner eignen Arbeitskraft ersetzt, unterscheidet sich qualitativ in &#92;&#92;nkeiner Weise von der zus&#92;&#92;u00e4tzlichen Portion Arbeit, wodurch er Mehrwerth&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;cluster&#92;&quot;:8589934592,&#92;&quot;begin&#92;&quot;:10119,&#92;&quot;end&#92;&quot;:11184,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;dnz&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; Unterricht&#92;&#92;nund Gymnastik. Die Fabrikinspektoren entdeckten bald aus den Zeugenverh&#92;&#92;u00f6ren&#92;&#92;nder Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht&#92;&#92;ngenie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, ebenso viel und oft mehr lernen.&#92;&#92;n(Hier folgt ein Zitat aus den Fabrikinspektorenberichten.) Weitere Belege findet&#92;&#92;nman in Seniers Rede auf dem soziologischen Kongre&#92;&#92;u00df zu Edinburg 1863. Er&#92;&#92;nzeigt hier auch u. A. nach, wie der einseitige, unproduktive und verl&#92;&#92;u00e4ngerte&#92;&#92;nSchultag der Kinder der h&#92;&#92;u00f6heren und mittleren Klassen die Arbeit der Lehre&#92;&#92;nnutzlos vermehrt, w&#92;&#92;u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht&#92;&#92;nnur fruchtlos, sondern absolut sch&#92;&#92;u00e4dlich verw&#92;&#92;u00fcstet: Aus dem Fabriksystem, wie&#92;&#92;nman im Detail bei Robert Owen verfolgen kann, entspro&#92;&#92;u00df der Keim der Erziehung&#92;&#92;nder Zukunft, welche f&#92;&#92;u00fcr alle Kinder &#92;&#92;u00fcber einem gewissen Alter produktive Arbeit&#92;&#92;nmit Unterricht und Gymnastik verbinden wird, nicht nur als eine Methode zur&#92;&#92;nSteigerung der gesellschaftlichen Produktion, sondern als die einzige Methode zur&#92;&#92;nproduktion vollseitig entwickelter Menschen.&#92;&#92;u201c&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-3418231376525603728&#92;&quot;,&#92;&quot;cluster&#92;&quot;:8589934592,&#92;&quot;begin&#92;&quot;:2284,&#92;&quot;end&#92;&quot;:3491,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;begin&#92;&quot;:10119,&#92;&quot;end&#92;&quot;:11184}],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;p395-396&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;mega&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; Unterricht zu empfangen. Das System halber Arbeit und &#92;&#92;nhalber Schule macht jede der beiden Besch&#92;&#92;u00e4ftigungen zur Ausruhung und &#92;&#92;nErholung von der andern und folglich viel angeme&#92;&#92;u00dfner f&#92;&#92;u00fcr das Kind als die &#92;&#92;nununterbrochne Fortdauer einer von beiden. Ein Junge, der von Morgens &#92;&#92;nfr&#92;&#92;u00fch in der Schule sitzt, und nun gar bei hei&#92;&#92;u00dfem Wetter, kann unm&#92;&#92;u00f6glich mit &#92;&#92;neinem andern wetteifern, der munter und aufgeweckt von seiner Arbeit &#92;&#92;nkommt&#92;&#92;u201c. Weitere Belege findet man in Senior&#x27;s   Rede auf dem &#92;&#92;nsociologischen Kongress zu Edinburg 1863. Er zeigt hier auch u. a. nach, wie &#92;&#92;nder einseitige, unproduktive und verl&#92;&#92;u00e4ngerte Schultag der Kinder der h&#92;&#92;u00f6- &#92;&#92;nheren und mittleren Klassen die Arbeit der Lehrer nutzlos vermehrt, &#92;&#92;n&#92;&#92;u201ew&#92;&#92;u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht nur fruchtlos, &#92;&#92;nsondern absolut sch&#92;&#92;u00e4dlich verw&#92;&#92;u00fcstet&#92;&#92;u201c. Aus dem Fabriksystem, wie man &#92;&#92;nin Detail bei Robert Owen verfolgen kann, entspro&#92;&#92;u00df der Keim der Erziehung &#92;&#92;nder Zukunft, welche f&#92;&#92;u00fcr alle Kinder &#92;&#92;u00fcber einem gewissen Alter produktive &#92;&#92;nArbeit mit Unterricht und Gymnastik verbinden wird, nicht nur als eine &#92;&#92;nMethode zur Steigerung der gesellschaftlichen Produktion, sondern als die &#92;&#92;neinzige Methode zur Produktion vollseitig entwickelter Menschen. &#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;cluster&#92;&quot;:17179869184,&#92;&quot;begin&#92;&quot;:9950,&#92;&quot;end&#92;&quot;:10368,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;dnz&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot;ulunterricht empfangen) wie folgt:&#92;&#92;n&#92;&#92;u201eIhr Erfolg bewies zun&#92;&#92;u00e4chst die M&#92;&#92;u00f6glichkeit der Verbindung von Unter&#92;&#92;u00ac&#92;&#92;nricht und Gymnastik mit Haudarbeit, also auch von Handarbeit mit Unterricht&#92;&#92;nund Gymnastik. Die Fabrikinspektoren entdeckten bald aus den Zeugenverh&#92;&#92;u00f6ren&#92;&#92;nder Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht&#92;&#92;ngenie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, ebenso viel und oft mehr lernen.&#92;&#92;n(Hi&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-3418231376525603728&#92;&quot;,&#92;&quot;cluster&#92;&quot;:17179869184,&#92;&quot;begin&#92;&quot;:1699,&#92;&quot;end&#92;&quot;:2145,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;begin&#92;&quot;:9950,&#92;&quot;end&#92;&quot;:10368}],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;p395-396&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;mega&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; Elementarunterricht als Zwangsbedingung &#92;&#92;nder Arbeit . Ihr Erfolg bewies zuerst die M&#92;&#92;u00f6glichkeit der Verbindung von &#92;&#92;nUnterricht und Gymnastik mit Handarbeit, also auch von Handarbeit mit        &#92;&#92;nUnterricht und Gymnastik. Die Fabrikinspektoren entdeckten bald aus den &#92;&#92;nZeugenverh&#92;&#92;u00f6ren der Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur &#92;&#92;nhalb so viel Unterricht genie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, eben so &#92;&#92;nviel und oft mehr lernen. &#92;&#92;u201eDi&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;cluster&#92;&quot;:17179869186,&#92;&quot;begin&#92;&quot;:17417,&#92;&quot;end&#92;&quot;:17618,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;dnz&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot;ieb, da&#92;&#92;u00df &#92;&#92;u201edie Zusammensetzung&#92;&#92;ndes kombinirten Arbeitspersonals aus Individuen beiderlei Geschlechts und der&#92;&#92;nverschiedensten Altersstufen, obgleich in ihrer naturw&#92;&#92;u00fcchsig brutalen, kapi&#92;&#92;u00ac&#92;&#92;ntalistischen For&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;4235214769221433558&#92;&quot;,&#92;&quot;cluster&#92;&quot;:17179869186,&#92;&quot;begin&#92;&quot;:370,&#92;&quot;end&#92;&quot;:572,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[{&#92;&quot;uid&#92;&quot;:&#92;&quot;-4012342302884855960&#92;&quot;,&#92;&quot;begin&#92;&quot;:17417,&#92;&quot;end&#92;&quot;:17618}],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;p402&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;mega&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; ein, &#92;&#92;nda&#92;&#92;u00df die Zusammensetzung des kombinirten Arbeitspersonals aus Individuen &#92;&#92;nbeiderlei Geschlechts und der verschiedensten Altersstufen, obgleich in ihrer &#92;&#92;nnaturw&#92;&#92;u00fcchsig brutalen, kapitalistischen For&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;263171422598165348&#92;&quot;,&#92;&quot;cluster&#92;&quot;:34359738368,&#92;&quot;begin&#92;&quot;:7536,&#92;&quot;end&#92;&quot;:7766,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;dnz&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot;&#92;&#92;u201eworin&#92;&#92;nverschiedene Arbeitsarten auf einfache Arbeit als ihre Ma&#92;&#92;u00dfeinheit reduzirt sind,&#92;&#92;nwerden durch einen gesellschaftlichen Proze&#92;&#92;u00df hinter dem R&#92;&#92;u00fccken der Produzenten&#92;&#92;nfestgesetzt und scheinen ihnen daher durch das Herkommen gegebe&#92;&quot;},{&#92;&quot;uid&#92;&quot;:&#92;&quot;-6501289226208964809&#92;&quot;,&#92;&quot;cluster&#92;&quot;:34359738368,&#92;&quot;begin&#92;&quot;:591,&#92;&quot;end&#92;&quot;:824,&#92;&quot;boiler&#92;&quot;:false,&#92;&quot;src&#92;&quot;:[{&#92;&quot;uid&#92;&quot;:&#92;&quot;263171422598165348&#92;&quot;,&#92;&quot;begin&#92;&quot;:7536,&#92;&quot;end&#92;&quot;:7766}],&#92;&quot;size&#92;&quot;:2,&#92;&quot;pboiler&#92;&quot;:0.0,&#92;&quot;id&#92;&quot;:&#92;&quot;p25&#92;&quot;,&#92;&quot;series&#92;&quot;:&#92;&quot;mega&#92;&quot;,&#92;&quot;text&#92;&quot;:&#92;&quot; worin &#92;&#92;nverschiedne Arbeitsarten auf einfache Arbeit als ihre Ma&#92;&#92;u00dfeinheit reducirt &#92;&#92;nsind, werden durch einen gesellschaftlichen Proze&#92;&#92;u00df hinter dem R&#92;&#92;u00fccken der &#92;&#92;nProduzenten festgesetzt und scheinen ihnen daher durch das Herkommen &#92;&#92;ngegebe&#92;&quot;}]&quot;' data-total-rows='12' data-total-columns='11' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;uid&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;cluster&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;begin&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;end&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;boiler&quot;, [&quot;boolean&quot;, &quot;bool&quot;]], [&quot;src&quot;, [&quot;unknown&quot;, &quot;list[struct[3]]&quot;]], [&quot;size&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;pboiler&quot;, [&quot;number&quot;, &quot;f64&quot;]], [&quot;id&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;series&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;text&quot;, [&quot;string&quot;, &quot;str&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "643427fd2ba6323b584afd12c53afea4", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Found <strong>6</strong> clusters of size <strong>2</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "4feddf6c8a3c41cc3a1e4ccd4cab0e62", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">This output shows the matching text content from the two texts.</span></span>"}, "type": "data"}]}, {"code_hash": "94f47ece71035ec7eac1606532617d33", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h4 id=\"bernstein_zur_theorie_des_arbeitswerth_1899-90a-mega-p25\">Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a &lt;&gt; MEGA p25</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">\u201eworin\nverschiedene Arbeitsarten auf einfache Arbeit als ihre Ma\u00dfeinheit reduzirt sind,\nwerden durch einen gesellschaftlichen Proze\u00df hinter dem R\u00fccken der Produzenten\nfestgesetzt und scheinen ihnen daher durch das Herkommen gegebe</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">worin \nverschiedne Arbeitsarten auf einfache Arbeit als ihre Ma\u00dfeinheit reducirt \nsind, werden durch einen gesellschaftlichen Proze\u00df hinter dem R\u00fccken der \nProduzenten festgesetzt und scheinen ihnen daher durch das Herkommen \ngegebe</span>\n<hr />\n<h4 id=\"bernstein_1897__790_der-sozialismus-und-die-gewerbliche-mega-p402\">Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche &lt;&gt; MEGA p402</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">ieb, da\u00df \u201edie Zusammensetzung\ndes kombinirten Arbeitspersonals aus Individuen beiderlei Geschlechts und der\nverschiedensten Altersstufen, obgleich in ihrer naturw\u00fcchsig brutalen, kapi\u00ac\ntalistischen For</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">ein, \nda\u00df die Zusammensetzung des kombinirten Arbeitspersonals aus Individuen \nbeiderlei Geschlechts und der verschiedensten Altersstufen, obgleich in ihrer \nnaturw\u00fcchsig brutalen, kapitalistischen For</span>\n<hr />\n<h4 id=\"bernstein_1897__790_der-sozialismus-und-die-gewerbliche-mega-p395-396\">Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche &lt;&gt; MEGA p395-396</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">Unterricht\nund Gymnastik. Die Fabrikinspektoren entdeckten bald aus den Zeugenverh\u00f6ren\nder Schulmeister, da\u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht\ngenie\u00dfen als die regelm\u00e4\u00dfigen Tagessch\u00fcler, ebenso viel und oft mehr lernen.\n(Hier folgt ein Zitat aus den Fabrikinspektorenberichten.) Weitere Belege findet\nman in Seniers Rede auf dem soziologischen Kongre\u00df zu Edinburg 1863. Er\nzeigt hier auch u. A. nach, wie der einseitige, unproduktive und verl\u00e4ngerte\nSchultag der Kinder der h\u00f6heren und mittleren Klassen die Arbeit der Lehre\nnutzlos vermehrt, w\u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht\nnur fruchtlos, sondern absolut sch\u00e4dlich verw\u00fcstet: Aus dem Fabriksystem, wie\nman im Detail bei Robert Owen verfolgen kann, entspro\u00df der Keim der Erziehung\nder Zukunft, welche f\u00fcr alle Kinder \u00fcber einem gewissen Alter produktive Arbeit\nmit Unterricht und Gymnastik verbinden wird, nicht nur als eine Methode zur\nSteigerung der gesellschaftlichen Produktion, sondern als die einzige Methode zur\nproduktion vollseitig entwickelter Menschen.\u201c</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">Unterricht zu empfangen. Das System halber Arbeit und \nhalber Schule macht jede der beiden Besch\u00e4ftigungen zur Ausruhung und \nErholung von der andern und folglich viel angeme\u00dfner f\u00fcr das Kind als die \nununterbrochne Fortdauer einer von beiden. Ein Junge, der von Morgens \nfr\u00fch in der Schule sitzt, und nun gar bei hei\u00dfem Wetter, kann unm\u00f6glich mit \neinem andern wetteifern, der munter und aufgeweckt von seiner Arbeit \nkommt\u201c. Weitere Belege findet man in Senior's   Rede auf dem \nsociologischen Kongress zu Edinburg 1863. Er zeigt hier auch u. a. nach, wie \nder einseitige, unproduktive und verl\u00e4ngerte Schultag der Kinder der h\u00f6- \nheren und mittleren Klassen die Arbeit der Lehrer nutzlos vermehrt, \n\u201ew\u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht nur fruchtlos, \nsondern absolut sch\u00e4dlich verw\u00fcstet\u201c. Aus dem Fabriksystem, wie man \nin Detail bei Robert Owen verfolgen kann, entspro\u00df der Keim der Erziehung \nder Zukunft, welche f\u00fcr alle Kinder \u00fcber einem gewissen Alter produktive \nArbeit mit Unterricht und Gymnastik verbinden wird, nicht nur als eine \nMethode zur Steigerung der gesellschaftlichen Produktion, sondern als die \neinzige Methode zur Produktion vollseitig entwickelter Menschen. </span>\n<hr />\n<h4 id=\"bernstein_1897__790_der-sozialismus-und-die-gewerbliche-mega-p395-396_1\">Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche &lt;&gt; MEGA p395-396</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">ulunterricht empfangen) wie folgt:\n\u201eIhr Erfolg bewies zun\u00e4chst die M\u00f6glichkeit der Verbindung von Unter\u00ac\nricht und Gymnastik mit Haudarbeit, also auch von Handarbeit mit Unterricht\nund Gymnastik. Die Fabrikinspektoren entdeckten bald aus den Zeugenverh\u00f6ren\nder Schulmeister, da\u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht\ngenie\u00dfen als die regelm\u00e4\u00dfigen Tagessch\u00fcler, ebenso viel und oft mehr lernen.\n(Hi</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">Elementarunterricht als Zwangsbedingung \nder Arbeit . Ihr Erfolg bewies zuerst die M\u00f6glichkeit der Verbindung von \nUnterricht und Gymnastik mit Handarbeit, also auch von Handarbeit mit      <br />\nUnterricht und Gymnastik. Die Fabrikinspektoren entdeckten bald aus den \nZeugenverh\u00f6ren der Schulmeister, da\u00df die Fabrikkinder, obgleich sie nur \nhalb so viel Unterricht genie\u00dfen als die regelm\u00e4\u00dfigen Tagessch\u00fcler, eben so \nviel und oft mehr lernen. \u201eDi</span>\n<hr />\n<h4 id=\"bernstein_1897__790_der-sozialismus-und-die-gewerbliche-mega-p402_1\">Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche &lt;&gt; MEGA p402</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">. Pestquelle des Verderbs und der Sklaverei, unter ent\u00ac\nsprechenden Verh\u00e4ltnissen umgekehrt zur Quelle humaner Entwicklung umschlagen\nmu</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">, Pest- \nquelle des Verderbs und der Sklaverei, unter entsprechenden Verh\u00e4ltnissen \numgekehrt zur Quelle humaner Entwicklung umschlagen mu</span>\n<hr />\n<h4 id=\"bernstein_zur_theorie_des_arbeitswerth_1899-90a-mega-p147\">Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a &lt;&gt; MEGA p147</h4>\n<span class=\"paragraph\"><strong>DNZ text:</strong></span>\n<span class=\"paragraph\">r Werth dieser Kraft (der Arbeitskraft) h\u00f6her, so \u00e4u\u00dfert sie\nsich aber auch in h\u00f6herer Arbeit und vergegenst\u00e4ndlicht sich daher () in den\u00ac\nselben Zeitr\u00e4umen in verh\u00e4ltni\u00dfm\u00e4\u00dfig h\u00f6heren Werthen\u201c (\u201eArbeitsproze\u00df und\nVerwerthungsproze\u00df\u201c Band 1, 2. Auflage, S. 186). Hier erscheint der Werth\u00ac\nder Arbeitskraft, der sich im Arbeitslohn vergegenst\u00e4ndlicht, als entscheidend f\u00fcr\nden Werth</span>\n<span class=\"paragraph\"><strong>MEGA text:</strong></span>\n<span class=\"paragraph\">werth hat als die einfache Arbeitskraft. Ist der Werth dieser Kraft h\u00f6her, \nso \u00e4u\u00dfert sie sich aber auch in h\u00f6herer Arbeit und vergegenst\u00e4ndlicht sich \n   daher, in denselben Zeitr\u00e4umen, in verh\u00e4ltni\u00dfm\u00e4\u00dfig h\u00f6heren Werthen. \nWelches jedoch immer der Gradunterschied zwischen Spinnarbeit und \nJuwelierarbeit, die Portion Arbeit, wodurch der Juwelenarbeiter nur den \nWerth seiner eignen Arbeitskraft ersetzt, unterscheidet sich qualitativ in \nkeiner Weise von der zus\u00e4tzlichen Portion Arbeit, wodurch er Mehrwerth</span>\n<hr /></span>"}, "type": "data"}]}, {"code_hash": "2daac0fb06746be6c91b48d0e50e663a", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Load sentence corpora and use character indices to get a list of sentences overlapping with the passages found by passim.</span></span>"}, "type": "data"}]}, {"code_hash": "57c30b7eab770770b3e147ff4d8304d7", "console": [], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "193a280b19f61faa54cefa434724c7e1", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9fa51d133ff0d8b89737081a61f37f10", "console": [], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "86a798a3fbd36e4de1d23b645aefec3e", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Load evaluation data and sentence corpora for comparison and evaluation of passim results.</span></span>"}, "type": "data"}]}, {"code_hash": "222416938b97ed1cf093213d590498a8", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='Kclp-0' random-id='d965f163-eecd-5611-b971-0deaa299f889'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;df81d5e4-4779-4117-b89c-7055c1cd7cc7&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p402.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p402:0002&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Ebenso leuchtet ein, &#92;&#92;nda&#92;&#92;u00df die Zusammensetzung des kombinirten Arbeitspersonals aus Individuen &#92;&#92;nbeiderlei Geschlechts und der verschiedensten Altersstufen, obgleich in ihrer &#92;&#92;nnaturw&#92;&#92;u00fcchsig brutalen, kapitalistischen Form, wo der Arbeiter f&#92;&#92;u00fcr den Pro- &#92;&#92;nduktionsproze&#92;&#92;u00df, nicht der Produktionsproze&#92;&#92;u00df f&#92;&#92;u00fcr den Arbeiter da ist, Pest- &#92;&#92;nquelle des Verderbs und der Sklaverei, unter entsprechenden Verh&#92;&#92;u00e4ltnissen &#92;&#92;numgekehrt zur Quelle humaner Entwicklung umschlagen mu&#92;&#92;u00df 312).&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0105&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;Sehr wahr&#92;&#92;u00ac&#92;&#92;nscheinlich hatte Marx dies im Sinne, als er schrieb, da&#92;&#92;u00df &#92;&#92;u201edie Zusammensetzung&#92;&#92;ndes kombinirten Arbeitspersonals aus Individuen beiderlei Geschlechts und der&#92;&#92;nverschiedensten Altersstufen, obgleich in ihrer naturw&#92;&#92;u00fcchsig brutalen, kapi&#92;&#92;u00ac&#92;&#92;ntalistischen Form... Pestquelle des Verderbs und der Sklaverei, unter ent&#92;&#92;u00ac&#92;&#92;nsprechenden Verh&#92;&#92;u00e4ltnissen umgekehrt zur Quelle humaner Entwicklung umschlagen&#92;&#92;nmu&#92;&#92;u00df&#92;&#92;u201c (a. a. O. S. 517).&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Mostly accurate. &#92;&#92;n---Omitted &#92;&#92;&#92;&quot;wo der Arbeiter f&#92;&#92;u00fcr den Produktionsproze&#92;&#92;u00df,nicht der Produktionsproze&#92;&#92;u00df f&#92;&#92;u00fcr den Arbeiter das ist&#92;&#92;&#92;&quot; &#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;0f93adf5-75c6-49a9-a4ce-7caea83f636c&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p147.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p147:0001&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Ist der Werth dieser Kraft h&#92;&#92;u00f6her, &#92;&#92;nso &#92;&#92;u00e4u&#92;&#92;u00dfert sie sich aber auch in h&#92;&#92;u00f6herer Arbeit und vergegenst&#92;&#92;u00e4ndlicht sich &#92;&#92;n   daher, in denselben Zeitr&#92;&#92;u00e4umen, in verh&#92;&#92;u00e4ltni&#92;&#92;u00dfm&#92;&#92;u00e4&#92;&#92;u00dfig h&#92;&#92;u00f6heren Werthen.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a:0073&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;In der That sagt Marx selbst an einer wichtigen Stelle (Kapitel 5 des ersten&#92;&#92;nBandes): &#92;&#92;u201eIst der Werth dieser Kraft (der Arbeitskraft) h&#92;&#92;u00f6her, so &#92;&#92;u00e4u&#92;&#92;u00dfert sie&#92;&#92;nsich aber auch in h&#92;&#92;u00f6herer Arbeit und vergegenst&#92;&#92;u00e4ndlicht sich daher () in den&#92;&#92;u00ac&#92;&#92;nselben Zeitr&#92;&#92;u00e4umen in verh&#92;&#92;u00e4ltni&#92;&#92;u00dfm&#92;&#92;u00e4&#92;&#92;u00dfig h&#92;&#92;u00f6heren Werthen&#92;&#92;u201c (&#92;&#92;u201eArbeitsproze&#92;&#92;u00df und&#92;&#92;nVerwerthungsproze&#92;&#92;u00df&#92;&#92;u201c Band 1, 2. Auflage, S. 186).&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation&#92;&#92;n--- Author added &#92;&#92;&#92;&quot;(der Arbeitskraft)&#92;&#92;&#92;&quot;&#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;598859f7-3f49-4cb8-8383-8aefbc4ca667&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p25.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p25:0005&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Die verschiednen Proportionen, worin &#92;&#92;nverschiedne Arbeitsarten auf einfache Arbeit als ihre Ma&#92;&#92;u00dfeinheit reducirt &#92;&#92;nsind, werden durch einen gesellschaftlichen Proze&#92;&#92;u00df hinter dem R&#92;&#92;u00fccken der &#92;&#92;nProduzenten festgesetzt und scheinen ihnen daher durch das Herkommen &#92;&#92;ngegeben.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a:0052&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;&#92;&#92;u201eDie verschiedenen Proportionen&#92;&#92;u201c, sagt Marx hier&#92;&#92;u00fcber, &#92;&#92;u201eworin&#92;&#92;nverschiedene Arbeitsarten auf einfache Arbeit als ihre Ma&#92;&#92;u00dfeinheit reduzirt sind,&#92;&#92;nwerden durch einen gesellschaftlichen Proze&#92;&#92;u00df hinter dem R&#92;&#92;u00fccken der Produzenten&#92;&#92;nfestgesetzt und scheinen ihnen daher durch das Herkommen gegeben&#92;&#92;u201c (&#92;&#92;u201eKapital&#92;&#92;u201c, I.&#92;&#92;n2. Auflage, S. 19).&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;reduzirt vs. reducirt  in MEGA and dnz_sentence&#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;4eb40d8e-928e-4b17-938f-8c72045db14d&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p395-396.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p395-396:0011&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Ihr Erfolg bewies zuerst die M&#92;&#92;u00f6glichkeit der Verbindung von &#92;&#92;nUnterricht und Gymnastik mit Handarbeit, also auch von Handarbeit mit        &#92;&#92;nUnterricht und Gymnastik.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0062&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;handelt (&#92;&#92;u00a7 9), &#92;&#92;u00fcber die Wirkungen dieser Vorschriften (da&#92;&#92;u00df n&#92;&#92;u00e4mlich kein Kind&#92;&#92;nvor Abwicklung der ersten Schulklassen zur Fabrikarbeit zugelassen werden soll&#92;&#92;nund da&#92;&#92;u00df Kinder unter vierzehn Jahren nur Fabrikarbeit leisten d&#92;&#92;u00fcrfen, wenn sie&#92;&#92;ngleichzeitig Schulunterricht empfangen) wie folgt:&#92;&#92;n&#92;&#92;u201eIhr Erfolg bewies zun&#92;&#92;u00e4chst die M&#92;&#92;u00f6glichkeit der Verbindung von Unter&#92;&#92;u00ac&#92;&#92;nricht und Gymnastik mit Haudarbeit, also auch von Handarbeit mit Unterricht&#92;&#92;nund Gymnastik.&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation&#92;&#92;n--- Unedited&#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;4eb40d8e-928e-4b17-938f-8c72045db14d&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p395-396.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p395-396:0012&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Die Fabrikinspektoren entdeckten bald aus den &#92;&#92;nZeugenverh&#92;&#92;u00f6ren der Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur &#92;&#92;nhalb so viel Unterricht genie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, eben so &#92;&#92;nviel und oft mehr lernen.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0063&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;Die Fabrikinspektoren entdeckten bald aus den Zeugenverh&#92;&#92;u00f6ren&#92;&#92;nder Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht&#92;&#92;ngenie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, ebenso viel und oft mehr lernen.&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation&#92;&#92;n--- &#92;&#92;&#92;&quot;Eben so&#92;&#92;&#92;&quot; versus &#92;&#92;&#92;&quot;ebenso&#92;&#92;&#92;&quot; in MEGA and dnz_sentence &#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;4eb40d8e-928e-4b17-938f-8c72045db14d&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p395-396.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p395-396:0017&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Weitere Belege findet man in Senior&#x27;s   Rede auf dem &#92;&#92;nsociologischen Kongress zu Edinburg 1863.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0065&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;Weitere Belege findet&#92;&#92;nman in Seniers Rede auf dem soziologischen Kongre&#92;&#92;u00df zu Edinburg 1863.&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation&#92;&#92;n--- Unedited. Some transcription errors&#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;4eb40d8e-928e-4b17-938f-8c72045db14d&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p395-396.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p395-396:0018&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Er zeigt hier auch u. a. nach, wie &#92;&#92;nder einseitige, unproduktive und verl&#92;&#92;u00e4ngerte Schultag der Kinder der h&#92;&#92;u00f6- &#92;&#92;nheren und mittleren Klassen die Arbeit der Lehrer nutzlos vermehrt, &#92;&#92;n&#92;&#92;u201ew&#92;&#92;u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht nur fruchtlos, &#92;&#92;nsondern absolut sch&#92;&#92;u00e4dlich verw&#92;&#92;u00fcstet&#92;&#92;u201c.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0066&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;Er&#92;&#92;nzeigt hier auch u. A. nach, wie der einseitige, unproduktive und verl&#92;&#92;u00e4ngerte&#92;&#92;nSchultag der Kinder der h&#92;&#92;u00f6heren und mittleren Klassen die Arbeit der Lehre&#92;&#92;nnutzlos vermehrt, w&#92;&#92;u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht&#92;&#92;nnur fruchtlos, sondern absolut sch&#92;&#92;u00e4dlich verw&#92;&#92;u00fcstet:&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation --- Unedited&#92;&quot;},{&#92;&quot;annotation_id&#92;&quot;:&#92;&quot;4eb40d8e-928e-4b17-938f-8c72045db14d&#92;&quot;,&#92;&quot;file&#92;&quot;:&#92;&quot;p395-396.txt&#92;&quot;,&#92;&quot;marx_sent_id&#92;&quot;:&#92;&quot;p395-396:0019&#92;&quot;,&#92;&quot;marx_sentence&#92;&quot;:&#92;&quot;Aus dem Fabriksystem, wie man &#92;&#92;nin Detail bei Robert Owen verfolgen kann, entspro&#92;&#92;u00df der Keim der Erziehung &#92;&#92;nder Zukunft, welche f&#92;&#92;u00fcr alle Kinder &#92;&#92;u00fcber einem gewissen Alter produktive &#92;&#92;nArbeit mit Unterricht und Gymnastik verbinden wird, nicht nur als eine &#92;&#92;nMethode zur Steigerung der gesellschaftlichen Produktion, sondern als die &#92;&#92;neinzige Methode zur Produktion vollseitig entwickelter Menschen.&#92;&quot;,&#92;&quot;dnz_sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0067&#92;&quot;,&#92;&quot;dnz_sentence&#92;&quot;:&#92;&quot;Aus dem Fabriksystem, wie&#92;&#92;nman im Detail bei Robert Owen verfolgen kann, entspro&#92;&#92;u00df der Keim der Erziehung&#92;&#92;nder Zukunft, welche f&#92;&#92;u00fcr alle Kinder &#92;&#92;u00fcber einem gewissen Alter produktive Arbeit&#92;&#92;nmit Unterricht und Gymnastik verbinden wird, nicht nur als eine Methode zur&#92;&#92;nSteigerung der gesellschaftlichen Produktion, sondern als die einzige Methode zur&#92;&#92;nproduktion vollseitig entwickelter Menschen.&#92;&#92;u201c (&#92;&#92;u201eKapital&#92;&#92;u201c, Band I, 2. Auflage,&#92;&#92;nS. 508/ Verh.&#92;&quot;,&#92;&quot;comments&#92;&quot;:&#92;&quot;Accurate citation &#92;&#92;n--- Unedited&#92;&quot;}]&quot;' data-total-rows='8' data-total-columns='7' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;annotation_id&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;file&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;marx_sent_id&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;marx_sentence&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;dnz_sent_id&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;dnz_sentence&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;comments&quot;, [&quot;string&quot;, &quot;str&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "10daab6c58ce3fe7dfd3fc9946c74f4c", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"passim-sentence-id-comparison\">Passim sentence id comparison</h2>\n<span class=\"paragraph\">Comparing passim matches with sentence evaluation pairs based on sentence id. For passim, we include any sentence that overlaps with the passage.</span>\n<h3 id=\"marx-sentences\">Marx sentences</h3>\n<ul>\n<li>8 marx sentence ids in evaluation data.</li>\n<li>15 marx sentence ids in passim results.</li>\n<li>8 sentence ids in common.</li>\n<li>7 sentence ids in passim results not in evaluation data:<blockquote>\n<span class=\"paragraph\">{'p395-396:0016', 'p147:0002', 'p395-396:0014', 'p147:0000', 'p395-396:0015', 'p395-396:0010', 'p395-396:0013'}</span>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"dnz-sentences\">DNZ sentences</h3>\n<ul>\n<li>8 marx sentence ids in evaluation data.</li>\n<li>10 marx sentence ids in passim results.</li>\n<li>8 sentence ids in common.</li>\n<li>2 sentence ids in passim results not in evaluation data:<blockquote>\n<span class=\"paragraph\">{'Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0064', 'Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a:0074'}</span>\n</blockquote>\n</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "afbf42c00d77338a15c2ea63a1a98869", "console": [], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b3713e58db1ae93f8b33e998368b0327", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='nWHF-0' random-id='621c722a-a21f-4e22-4aba-4468128aacc9'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0062&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:62,&#92;&quot;char_idx&#92;&quot;:9698,&#92;&quot;text&#92;&quot;:&#92;&quot;handelt (&#92;&#92;u00a7 9), &#92;&#92;u00fcber die Wirkungen dieser Vorschriften (da&#92;&#92;u00df n&#92;&#92;u00e4mlich kein Kind&#92;&#92;nvor Abwicklung der ersten Schulklassen zur Fabrikarbeit zugelassen werden soll&#92;&#92;nund da&#92;&#92;u00df Kinder unter vierzehn Jahren nur Fabrikarbeit leisten d&#92;&#92;u00fcrfen, wenn sie&#92;&#92;ngleichzeitig Schulunterricht empfangen) wie folgt:&#92;&#92;n&#92;&#92;u201eIhr Erfolg bewies zun&#92;&#92;u00e4chst die M&#92;&#92;u00f6glichkeit der Verbindung von Unter&#92;&#92;u00ac&#92;&#92;nricht und Gymnastik mit Haudarbeit, also auch von Handarbeit mit Unterricht&#92;&#92;nund Gymnastik.&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:10144},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0063&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:63,&#92;&quot;char_idx&#92;&quot;:10145,&#92;&quot;text&#92;&quot;:&#92;&quot;Die Fabrikinspektoren entdeckten bald aus den Zeugenverh&#92;&#92;u00f6ren&#92;&#92;nder Schulmeister, da&#92;&#92;u00df die Fabrikkinder, obgleich sie nur halb so viel Unterricht&#92;&#92;ngenie&#92;&#92;u00dfen als die regelm&#92;&#92;u00e4&#92;&#92;u00dfigen Tagessch&#92;&#92;u00fcler, ebenso viel und oft mehr lernen.&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:10363},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0065&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:65,&#92;&quot;char_idx&#92;&quot;:10423,&#92;&quot;text&#92;&quot;:&#92;&quot;Weitere Belege findet&#92;&#92;nman in Seniers Rede auf dem soziologischen Kongre&#92;&#92;u00df zu Edinburg 1863.&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:10513},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0066&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:66,&#92;&quot;char_idx&#92;&quot;:10514,&#92;&quot;text&#92;&quot;:&#92;&quot;Er&#92;&#92;nzeigt hier auch u. A. nach, wie der einseitige, unproduktive und verl&#92;&#92;u00e4ngerte&#92;&#92;nSchultag der Kinder der h&#92;&#92;u00f6heren und mittleren Klassen die Arbeit der Lehre&#92;&#92;nnutzlos vermehrt, w&#92;&#92;u00e4hrend er Zeit, Gesundheit und Energie der Kinder nicht&#92;&#92;nnur fruchtlos, sondern absolut sch&#92;&#92;u00e4dlich verw&#92;&#92;u00fcstet:&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:10795},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0067&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:67,&#92;&quot;char_idx&#92;&quot;:10796,&#92;&quot;text&#92;&quot;:&#92;&quot;Aus dem Fabriksystem, wie&#92;&#92;nman im Detail bei Robert Owen verfolgen kann, entspro&#92;&#92;u00df der Keim der Erziehung&#92;&#92;nder Zukunft, welche f&#92;&#92;u00fcr alle Kinder &#92;&#92;u00fcber einem gewissen Alter produktive Arbeit&#92;&#92;nmit Unterricht und Gymnastik verbinden wird, nicht nur als eine Methode zur&#92;&#92;nSteigerung der gesellschaftlichen Produktion, sondern als die einzige Methode zur&#92;&#92;nproduktion vollseitig entwickelter Menschen.&#92;&#92;u201c (&#92;&#92;u201eKapital&#92;&#92;u201c, Band I, 2. Auflage,&#92;&#92;nS. 508/ Verh.&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:11229},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein,_1897__790_Der-Sozialismus-und-die-gewerbliche:0105&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:105,&#92;&quot;char_idx&#92;&quot;:17357,&#92;&quot;text&#92;&quot;:&#92;&quot;Sehr wahr&#92;&#92;u00ac&#92;&#92;nscheinlich hatte Marx dies im Sinne, als er schrieb, da&#92;&#92;u00df &#92;&#92;u201edie Zusammensetzung&#92;&#92;ndes kombinirten Arbeitspersonals aus Individuen beiderlei Geschlechts und der&#92;&#92;nverschiedensten Altersstufen, obgleich in ihrer naturw&#92;&#92;u00fcchsig brutalen, kapi&#92;&#92;u00ac&#92;&#92;ntalistischen Form... Pestquelle des Verderbs und der Sklaverei, unter ent&#92;&#92;u00ac&#92;&#92;nsprechenden Verh&#92;&#92;u00e4ltnissen umgekehrt zur Quelle humaner Entwicklung umschlagen&#92;&#92;nmu&#92;&#92;u00df&#92;&#92;u201c (a. a. O. S. 517).&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:17777},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a:0052&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:52,&#92;&quot;char_idx&#92;&quot;:7481,&#92;&quot;text&#92;&quot;:&#92;&quot;&#92;&#92;u201eDie verschiedenen Proportionen&#92;&#92;u201c, sagt Marx hier&#92;&#92;u00fcber, &#92;&#92;u201eworin&#92;&#92;nverschiedene Arbeitsarten auf einfache Arbeit als ihre Ma&#92;&#92;u00dfeinheit reduzirt sind,&#92;&#92;nwerden durch einen gesellschaftlichen Proze&#92;&#92;u00df hinter dem R&#92;&#92;u00fccken der Produzenten&#92;&#92;nfestgesetzt und scheinen ihnen daher durch das Herkommen gegeben&#92;&#92;u201c (&#92;&#92;u201eKapital&#92;&#92;u201c, I.&#92;&#92;n2. Auflage, S. 19).&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:7802},{&#92;&quot;file&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a.txt&#92;&quot;,&#92;&quot;sent_id&#92;&quot;:&#92;&quot;Bernstein_Zur_Theorie_des_Arbeitswerth_1899-90a:0073&#92;&quot;,&#92;&quot;sent_idx&#92;&quot;:73,&#92;&quot;char_idx&#92;&quot;:11135,&#92;&quot;text&#92;&quot;:&#92;&quot;In der That sagt Marx selbst an einer wichtigen Stelle (Kapitel 5 des ersten&#92;&#92;nBandes): &#92;&#92;u201eIst der Werth dieser Kraft (der Arbeitskraft) h&#92;&#92;u00f6her, so &#92;&#92;u00e4u&#92;&#92;u00dfert sie&#92;&#92;nsich aber auch in h&#92;&#92;u00f6herer Arbeit und vergegenst&#92;&#92;u00e4ndlicht sich daher () in den&#92;&#92;u00ac&#92;&#92;nselben Zeitr&#92;&#92;u00e4umen in verh&#92;&#92;u00e4ltni&#92;&#92;u00dfm&#92;&#92;u00e4&#92;&#92;u00dfig h&#92;&#92;u00f6heren Werthen&#92;&#92;u201c (&#92;&#92;u201eArbeitsproze&#92;&#92;u00df und&#92;&#92;nVerwerthungsproze&#92;&#92;u00df&#92;&#92;u201c Band 1, 2. Auflage, S. 186).&#92;&quot;,&#92;&quot;char_end_idx&#92;&quot;:11489}]&quot;' data-total-rows='8' data-total-columns='6' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;file&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;sent_id&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;sent_idx&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;char_idx&quot;, [&quot;integer&quot;, &quot;i64&quot;]], [&quot;text&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;char_end_idx&quot;, [&quot;integer&quot;, &quot;i64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "875c5ec9c1ee602ece3ed694e978a0f8", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='iLit-0' random-id='c104ae89-599c-fe4e-5534-92740611b4b5'><marimo-slider data-initial-value='0' data-label='&quot;&lt;span class=&#92;&quot;markdown prose dark:prose-invert&#92;&quot;&gt;&lt;span class=&#92;&quot;paragraph&#92;&quot;&gt;passim cluster&lt;/span&gt;&lt;/span&gt;&quot;' data-start='0' data-stop='5' data-step='1' data-steps='[]' data-debounce='false' data-disabled='false' data-orientation='&quot;horizontal&quot;' data-show-value='false' data-include-input='false' data-full-width='false'></marimo-slider></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "cabdf2e994c4d8e9711c25b8dca33aa1", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "<div style='display: flex;flex: 1;flex-direction: row;justify-content: center;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'><section class='page'><header><h1>passim</h2><p class='info'>cluster 0</p></header> die, da\u00df es dann doch die Arbeitsl\u00f6hne und nicht die Arbeilsmengen sind,\nbei denen wir zuletzt das Geheimni\u00df des Werthes der Waaren zu suchen haben.\n<mark>In der That sagt Marx selbst an einer wichtigen Stelle (Kapitel 5 des ersten\nBandes): \u201eIst der Werth dieser Kraft (der Arbeitskraft) h\u00f6her, so \u00e4u\u00dfert sie\nsich aber auch in h\u00f6herer Arbeit und vergegenst\u00e4ndlicht sich daher () in den\u00ac\nselben Zeitr\u00e4umen in verh\u00e4ltni\u00dfm\u00e4\u00dfig h\u00f6heren Werthen\u201c (\u201eArbeitsproze\u00df und\nVerwerthungsproze\u00df\u201c Band 1, 2. Auflage, S. 186).</mark> <mark>Hier erscheint der Werth\u00ac\nder Arbeitskraft, der sich im Arbeitslohn vergegenst\u00e4ndlicht, als entscheidend f\u00fcr\nden Werth des Produkts.</mark> M\u00fc\u00dften wir dies als allgemein geltend annehmen,\nso w\u00fcrde die Marxsche Werththeorie meines Erachtens ein ganz anderes Gesicht,\ngewinnen, als sie bisher nach der Darstellung aller ihrer Erkl\u00e4rer trug. Marxi\nselbst nicht ausgenommen, der in seinem Vortrag \u201eLohn, Preis und Profit\u201c\nausdr\u00fccklich sagt: \u201eEs ist deshalb etwas ganz</section><section class='page highlight2'><header><h1>evaluation sentence pairs</h2></header> die, da\u00df es dann doch die Arbeitsl\u00f6hne und nicht die Arbeilsmengen sind,\nbei denen wir zuletzt das Geheimni\u00df des Werthes der Waaren zu suchen haben.\n<mark>In der That sagt Marx selbst an einer wichtigen Stelle (Kapitel 5 des ersten\nBandes): \u201eIst der Werth dieser Kraft (der Arbeitskraft) h\u00f6her, so \u00e4u\u00dfert sie\nsich aber auch in h\u00f6herer Arbeit und vergegenst\u00e4ndlicht sich daher () in den\u00ac\nselben Zeitr\u00e4umen in verh\u00e4ltni\u00dfm\u00e4\u00dfig h\u00f6heren Werthen\u201c (\u201eArbeitsproze\u00df und\nVerwerthungsproze\u00df\u201c Band 1, 2. Auflage, S. 186).</mark> Hier erscheint der Werth\u00ac\nder Arbeitskraft, der sich im Arbeitslohn vergegenst\u00e4ndlicht, als entscheidend f\u00fcr\nden Werth des Produkts. M\u00fc\u00dften wir dies als allgemein geltend annehmen,\nso w\u00fcrde die Marxsche Werththeorie meines Erachtens ein ganz anderes Gesicht,\ngewinnen, als sie bisher nach der Darstellung aller ihrer Erkl\u00e4rer trug. Marxi\nselbst nicht ausgenommen, der in seinem Vortrag \u201eLohn, Preis und Profit\u201c\nausdr\u00fccklich sagt: \u201eEs ist deshalb etwas ganz Anderes, die</section></div>"}, "type": "data"}]}, {"code_hash": "e854d7c63d6778fb4d499f45b60c541d", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"conclusion\">Conclusion</h2>\n<span class=\"paragraph\">All of the sentence in our evaluation pairs are found by passim.</span>\n<span class=\"paragraph\">Passim also finds additional sentences; the sentences found are around the passages of interest, so passim is identifying extra content we did not include before or after the quote.</span>\n<span class=\"paragraph\">The gaps in some of the quotations also means that passim groups interrupted quotes in different clusters.</span></span>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.14.9"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.14.9%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22medium%22%2C%0A%20%20%20%20app_title%3D%22Passim%20evaluation%22%2C%0A%20%20%20%20css_file%3D%22highlight.css%22%2C%0A)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20polars%20as%20pl%0A%20%20%20%20return%20mo%2C%20pl%0A%0A%0A%40app.cell%0Adef%20_(pl)%3A%0A%20%20%20%20df%20%3D%20pl.read_ndjson(%0A%20%20%20%20%20%20%20%20%22data%2Fpassim%2Foutput%2Fdefault%2Fout.json%2Fpart-00000-dbd8cab7-6c9f-4866-b676-ff2bcd4b0890-c000.json%22%0A%20%20%20%20)%0A%20%20%20%20df%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo)%3A%0A%20%20%20%20unique_clusters%20%3D%20len(df%5B%22cluster%22%5D.unique())%0A%20%20%20%20cluster_sizes%20%3D%20%22%2C%22.join(%5Bstr(s)%20for%20s%20in%20df%5B%22size%22%5D.unique().to_list()%5D)%0A%0A%20%20%20%20mo.md(f%22Found%20**%7Bunique_clusters%7D**%20clusters%20of%20size%20**%7Bcluster_sizes%7D**.%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22This%20output%20shows%20the%20matching%20text%20content%20from%20the%20two%20texts.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo%2C%20pl)%3A%0A%20%20%20%20output%20%3D%20%5B%5D%0A%0A%20%20%20%20for%20cluster%2C%20rows%20in%20df.group_by(%22cluster%22)%3A%0A%20%20%20%20%20%20%20%20dnz_content%20%3D%20rows.filter(pl.col(%22series%22)%20%3D%3D%20%22dnz%22).row(0%2C%20named%3DTrue)%0A%20%20%20%20%20%20%20%20mega_content%20%3D%20rows.filter(pl.col(%22series%22)%20%3D%3D%20%22mega%22).row(0%2C%20named%3DTrue)%0A%0A%20%20%20%20%20%20%20%20output.append(f%22%23%23%23%23%20%7Bdnz_content%5B'id'%5D%7D%20%3C%3E%20MEGA%20%7Bmega_content%5B'id'%5D%7D%22)%0A%20%20%20%20%20%20%20%20output.append(%22**DNZ%20text%3A**%5Cn%22)%0A%20%20%20%20%20%20%20%20output.append(dnz_content%5B%22text%22%5D)%0A%20%20%20%20%20%20%20%20output.append(%22%5Cn**MEGA%20text%3A**%5Cn%22)%0A%20%20%20%20%20%20%20%20output.append(mega_content%5B%22text%22%5D)%0A%20%20%20%20%20%20%20%20output.append(%22---%22)%0A%0A%0A%20%20%20%20mo.md(%22%5Cn%22.join(output))%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22Load%20sentence%20corpora%20and%20use%20character%20indices%20to%20get%20a%20list%20of%20sentences%20overlapping%20with%20the%20passages%20found%20by%20passim.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pl)%3A%0A%20%20%20%20marx_sentences%20%3D%20pl.read_ndjson(%0A%20%20%20%20%20%20%20%20%22data%2Fsentence-corpora%2Fmega-sample-sents.jsonl%22%0A%20%20%20%20)%0A%20%20%20%20%23%20calculate%20sentence%20end%20index%0A%20%20%20%20marx_sentences%20%3D%20marx_sentences.with_columns(%0A%20%20%20%20%20%20%20%20char_end_idx%3Dpl.col(%22char_idx%22).add(pl.col(%22text%22).str.len_chars())%0A%20%20%20%20)%0A%20%20%20%20dnz_sentences%20%3D%20pl.read_ndjson(%0A%20%20%20%20%20%20%20%20(%22data%2Fsentence-corpora%2Fdnz-sample-sents.jsonl%22)%0A%20%20%20%20)%0A%20%20%20%20%23%20calculate%20sentence%20end%20index%0A%20%20%20%20dnz_sentences%20%3D%20dnz_sentences.with_columns(%0A%20%20%20%20%20%20%20%20char_end_idx%3Dpl.col(%22char_idx%22).add(pl.col(%22text%22).str.len_chars())%0A%20%20%20%20)%0A%20%20%20%20return%20dnz_sentences%2C%20marx_sentences%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20dnz_sentences%2C%20marx_sentences%2C%20pl)%3A%0A%20%20%20%20%23%20passim%20id%20is%20filename%20without%20extensin%3B%20add%20it%20back%20for%20matching%0A%20%20%20%20passim_df%20%3D%20df.with_columns(file%3Dpl.col(%22id%22)%20%2B%20pl.lit(%22.txt%22))%0A%20%20%20%20%23%20combine%20sentence%20corpora%20into%20a%20single%20dataframe%0A%20%20%20%20all_sentences%20%3D%20pl.concat(%5Bmarx_sentences%2C%20dnz_sentences%5D)%0A%0A%20%20%20%20%23%20then%20do%20a%20conditional%20join%20to%20get%20sentence%20ids%20for%20passim%20results%0A%20%20%20%20passim_df%20%3D%20passim_df.join_where(%0A%20%20%20%20%20%20%20%20all_sentences%2C%0A%20%20%20%20%20%20%20%20%23%20join%20based%20on%20filename%20and%20any%20overlapping%20characters%0A%20%20%20%20%20%20%20%20%23%20we%20expect%20multiple%20sentences%20for%20several%20of%20the%20passages%20found%20by%20passim%0A%20%20%20%20%20%20%20%20pl.col(%22file%22)%20%3D%3D%20pl.col(%22file_right%22)%2C%0A%20%20%20%20%20%20%20%20pl.col(%22begin%22)%20%3C%20pl.col(%22char_end_idx%22)%2C%0A%20%20%20%20%20%20%20%20pl.col(%22end%22)%20%3E%20pl.col(%22char_idx%22)%2C%0A%20%20%20%20)%0A%20%20%20%20%23%20select%20the%20fields%20we%20need%20to%20keep%20for%20evaluation%0A%20%20%20%20passim_df%20%3D%20passim_df.select(%0A%20%20%20%20%20%20%20%20%22cluster%22%2C%0A%20%20%20%20%20%20%20%20%22file%22%2C%0A%20%20%20%20%20%20%20%20%22sent_id%22%2C%0A%20%20%20%20%20%20%20%20%22series%22%2C%0A%20%20%20%20%20%20%20%20%22begin%22%2C%0A%20%20%20%20%20%20%20%20%22end%22%2C%0A%20%20%20%20%20%20%20%20%22char_idx%22%2C%0A%20%20%20%20%20%20%20%20%22char_end_idx%22%2C%0A%20%20%20%20%20%20%20%20%22text%22%2C%0A%20%20%20%20%20%20%20%20%22text_right%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(passim_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(passim_df%2C%20pl)%3A%0A%20%20%20%20%23%20get%20a%20list%20of%20all%20sentences%20for%20each%20series%0A%20%20%20%20passim_marx_sent_ids%20%3D%20set(%0A%20%20%20%20%20%20%20%20passim_df.filter(pl.col(%22series%22)%20%3D%3D%20%22mega%22)%5B%22sent_id%22%5D.to_list()%0A%20%20%20%20)%0A%20%20%20%20passim_dnz_sent_ids%20%3D%20set(%0A%20%20%20%20%20%20%20%20passim_df.filter(pl.col(%22series%22)%20%3D%3D%20%22dnz%22)%5B%22sent_id%22%5D.to_list()%0A%20%20%20%20)%0A%20%20%20%20return%20passim_dnz_sent_ids%2C%20passim_marx_sent_ids%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22Load%20evaluation%20data%20and%20sentence%20corpora%20for%20comparison%20and%20evaluation%20of%20passim%20results.%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pl)%3A%0A%20%20%20%20%23%20load%20the%20evaulation%20data%20and%20filter%20to%20those%20that%20have%20sentence%20ids%20for%20both%20sentence%20corpora%0A%20%20%20%20eval_pairs_df%20%3D%20pl.read_csv(%0A%20%20%20%20%20%20%20%20%22data%2Fsentence-eval-pairs%2Fdnz_marx_sentence_pairs.csv%22%0A%20%20%20%20)%0A%20%20%20%20eval_pairs_df%20%3D%20eval_pairs_df.filter(%0A%20%20%20%20%20%20%20%20pl.col(%22marx_sent_id%22).is_not_null()%2C%20pl.col(%22dnz_sent_id%22).is_not_null()%0A%20%20%20%20)%0A%20%20%20%20eval_pairs_df%0A%20%20%20%20return%20(eval_pairs_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(eval_pairs_df%2C%20mo%2C%20passim_dnz_sent_ids%2C%20passim_marx_sent_ids)%3A%0A%20%20%20%20%23%20what%20is%20the%20overlap%20between%20sentence%20ids%3F%0A%20%20%20%20eval_marx_sent_ids%20%3D%20set(eval_pairs_df%5B%22marx_sent_id%22%5D.to_list())%0A%20%20%20%20eval_dnz_sent_ids%20%3D%20set(eval_pairs_df%5B%22dnz_sent_id%22%5D.to_list())%0A%0A%20%20%20%20passim_marx_sent_ids.issuperset(eval_marx_sent_ids)%0A%20%20%20%20%23%20in%20common%0A%20%20%20%20passim_marx_sent_ids%20%26%20eval_marx_sent_ids%0A%20%20%20%20%23%20passim_marx_sent_ids%0A%0A%20%20%20%20%23%20report%20on%20how%20they%20match%20up%0A%20%20%20%20mo.md(f%22%22%22%23%23%20Passim%20sentence%20id%20comparison%0A%0A%20%20%20%20Comparing%20passim%20matches%20with%20sentence%20evaluation%20pairs%20based%20on%20sentence%20id.%20For%20passim%2C%20we%20include%20any%20sentence%20that%20overlaps%20with%20the%20passage.%0A%0A%20%20%20%20%23%23%23%20Marx%20sentences%0A%20%20%20%20-%20%7Blen(eval_marx_sent_ids)%7D%20marx%20sentence%20ids%20in%20evaluation%20data.%0A%20%20%20%20-%20%7Blen(passim_marx_sent_ids)%7D%20marx%20sentence%20ids%20in%20passim%20results.%0A%20%20%20%20-%20%7Blen(eval_marx_sent_ids%20%26%20passim_marx_sent_ids)%7D%20sentence%20ids%20in%20common.%0A%20%20%20%20-%20%7Blen(passim_marx_sent_ids%20-%20eval_marx_sent_ids)%7D%20sentence%20ids%20in%20passim%20results%20not%20in%20evaluation%20data%3A%0A%20%20%20%20%3E%20%7B(passim_marx_sent_ids%20-%20eval_marx_sent_ids)%7D%0A%0A%20%20%20%20%23%23%23%20DNZ%20sentences%0A%20%20%20%20-%20%7Blen(eval_dnz_sent_ids)%7D%20marx%20sentence%20ids%20in%20evaluation%20data.%0A%20%20%20%20-%20%7Blen(passim_dnz_sent_ids)%7D%20marx%20sentence%20ids%20in%20passim%20results.%0A%20%20%20%20-%20%7Blen(eval_dnz_sent_ids%20%26%20passim_dnz_sent_ids)%7D%20sentence%20ids%20in%20common.%0A%20%20%20%20-%20%7Blen(passim_dnz_sent_ids%20-%20eval_dnz_sent_ids)%7D%20sentence%20ids%20in%20passim%20results%20not%20in%20evaluation%20data%3A%0A%20%20%20%20%3E%20%7B(passim_dnz_sent_ids%20-%20eval_dnz_sent_ids)%7D%0A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(eval_pairs_df%2C%20marx_sentences%2C%20pl)%3A%0A%20%20%20%20%23%20join%20marx%20and%20dnz%20sentences%20in%20order%20to%20get%20character%20indices%20for%20highlighting%0A%20%20%20%20eval_df%20%3D%20eval_pairs_df.join(%0A%20%20%20%20%20%20%20%20marx_sentences.select(%22sent_id%22%2C%20%22file%22%2C%20%22char_idx%22%2C%20%22char_end_idx%22)%2C%0A%20%20%20%20%20%20%20%20left_on%3Dpl.col(%22marx_sent_id%22)%2C%0A%20%20%20%20%20%20%20%20right_on%3Dpl.col(%22sent_id%22)%2C%0A%20%20%20%20%20%20%20%20how%3D%22left%22%2C%0A%20%20%20%20).rename(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22char_idx%22%3A%20%22marx_start_index%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22char_end_idx%22%3A%20%22marx_end_index%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22file%22%3A%20%22marx_file%22%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(dnz_sentences%2C%20eval_pairs_df%2C%20pl)%3A%0A%20%20%20%20%23%20get%20the%20DNZ%20sentences%20in%20our%20evaluation%20pairs%2C%20so%20we%20can%20highlight%20them%0A%20%20%20%20dnz_eval_sent_ids%20%3D%20eval_pairs_df%5B%22dnz_sent_id%22%5D.unique().to_list()%0A%20%20%20%20dnz_eval_sents%20%3D%20dnz_sentences.filter(%0A%20%20%20%20%20%20%20%20pl.col(%22sent_id%22).is_in(dnz_eval_sent_ids)%0A%20%20%20%20)%0A%20%20%20%20dnz_eval_sents%0A%20%20%20%20return%20(dnz_eval_sents%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo%2C%20passim_df)%3A%0A%20%20%20%20uniq_clusters%20%3D%20passim_df%5B%22cluster%22%5D.unique().to_list()%0A%20%20%20%20cluster_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D0%2C%0A%20%20%20%20%20%20%20%20stop%3Dlen(uniq_clusters)%20-%201%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20label%3D%22passim%20cluster%22%2C%0A%20%20%20%20)%0A%20%20%20%20cluster_slider%0A%20%20%20%20return%20cluster_slider%2C%20uniq_clusters%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(cluster_slider%2C%20dnz_eval_sents%2C%20mo%2C%20passim_df%2C%20pl%2C%20uniq_clusters)%3A%0A%20%20%20%20%23%20create%20panels%20with%20highlighted%20text%0A%20%20%20%20from%20remarx.highlight_utils%20import%20highlight_spans%0A%0A%0A%20%20%20%20def%20highlight_passim_passages()%3A%0A%20%20%20%20%20%20%20%20%23%20get%20cluster%20id%0A%20%20%20%20%20%20%20%20cluster_id%20%3D%20uniq_clusters%5Bcluster_slider.value%5D%0A%20%20%20%20%20%20%20%20%23%20find%20passim%20passages%20for%20dnz%20text%20in%20cluster%0A%20%20%20%20%20%20%20%20passim_passages%20%3D%20passim_df.filter(%0A%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22cluster%22).eq(cluster_id)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22series%22).eq(%22dnz%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20dnz_filename%20%3D%20passim_passages.row(0%2C%20named%3DTrue)%5B%22file%22%5D%0A%20%20%20%20%20%20%20%20with%20open(f%22data%2Fdnz-sample-articles%2F%7Bdnz_filename%7D%22)%20as%20dnzfile%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20dnztext%20%3D%20dnzfile.read()%0A%0A%20%20%20%20%20%20%20%20spans%20%3D%20passim_passages.select(%22char_idx%22%2C%20%22char_end_idx%22).rows()%0A%0A%20%20%20%20%20%20%20%20highlighted_text%20%3D%20highlight_spans(dnztext%2C%20spans)%0A%20%20%20%20%20%20%20%20%23%20subset%20the%20text%20around%20the%20quotes%20with%20some%20padding%0A%20%20%20%20%20%20%20%20min_index%20%3D%20passim_passages%5B%22char_idx%22%5D.min()%20-%20150%0A%20%20%20%20%20%20%20%20max_index%20%3D%20passim_passages%5B%22char_end_idx%22%5D.max()%20%2B%20350%0A%0A%20%20%20%20%20%20%20%20highlighted_text%20%3D%20highlighted_text%5Bmin_index%3Amax_index%5D%0A%20%20%20%20%20%20%20%20return%20cluster_id%2C%20highlighted_text%2C%20dnz_filename%2C%20min_index%2C%20max_index%0A%0A%0A%20%20%20%20def%20passim_panel(cluster_id%2C%20highlighted_text)%3A%0A%20%20%20%20%20%20%20%20return%20mo.Html(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%3Csection%20class%3D'page'%3E%3Cheader%3E%3Ch1%3Epassim%3C%2Fh2%3E%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20f%22%3Cp%20class%3D'info'%3Ecluster%20%7Bcluster_id%7D%3C%2Fp%3E%3C%2Fheader%3E%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20highlighted_text%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%3C%2Fsection%3E%22%0A%20%20%20%20%20%20%20%20)%0A%0A%0A%20%20%20%20def%20highlight_sentence_pairs(dnz_filename%2C%20min_index%2C%20max_index)%3A%0A%20%20%20%20%20%20%20%20eval_subset%20%3D%20dnz_eval_sents.filter(%0A%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22file%22).eq(dnz_filename)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22char_idx%22)%20%3C%20max_index%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%22char_end_idx%22)%20%3E%20min_index%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20spans%20%3D%20eval_subset.select(%22char_idx%22%2C%20%22char_end_idx%22).rows()%0A%0A%20%20%20%20%20%20%20%20with%20open(f%22data%2Fdnz-sample-articles%2F%7Bdnz_filename%7D%22)%20as%20dnzfile%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20dnztext%20%3D%20dnzfile.read()%0A%0A%20%20%20%20%20%20%20%20return%20highlight_spans(dnztext%2C%20spans)%5Bmin_index%3Amax_index%5D%0A%0A%0A%20%20%20%20def%20eval_panel(text)%3A%0A%20%20%20%20%20%20%20%20return%20mo.Html(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%3Csection%20class%3D'page%20highlight2'%3E%3Cheader%3E%3Ch1%3Eevaluation%20sentence%20pairs%3C%2Fh2%3E%3C%2Fheader%3E%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20text%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%3C%2Fsection%3E%22%0A%20%20%20%20%20%20%20%20)%0A%0A%0A%20%20%20%20cluster_id%2C%20highlighted_text%2C%20dnz_filename%2C%20min_index%2C%20max_index%20%3D%20(%0A%20%20%20%20%20%20%20%20highlight_passim_passages()%0A%20%20%20%20)%0A%0A%20%20%20%20mo.hstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20passim_panel(cluster_id%2C%20highlighted_text)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20eval_panel(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20highlight_sentence_pairs(dnz_filename%2C%20min_index%2C%20max_index)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20justify%3D%22center%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Conclusion%0A%0A%20%20%20%20All%20of%20the%20sentence%20in%20our%20evaluation%20pairs%20are%20found%20by%20passim.%0A%0A%20%20%20%20Passim%20also%20finds%20additional%20sentences%3B%20the%20sentences%20found%20are%20around%20the%20passages%20of%20interest%2C%20so%20passim%20is%20identifying%20extra%20content%20we%20did%20not%20include%20before%20or%20after%20the%20quote.%0A%0A%20%20%20%20The%20gaps%20in%20some%20of%20the%20quotations%20also%20means%20that%20passim%20groups%20interrupted%20quotes%20in%20different%20clusters.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">db076d5c32bbe8aca8bdb21b3d38c7e99a36f259fb1c10a9277a7eb4c994525e</marimo-code-hash>
</body>
</html>
